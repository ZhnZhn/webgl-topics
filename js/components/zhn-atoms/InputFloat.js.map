{"version":3,"sources":["../../../src/components/zhn-atoms/InputFloat.jsx"],"names":["_hmModeStyle","STYLE","NOT_VALID","VALID_CHANGED","VALID_NOT_CHANGED","InputFloat","props","_getInitedState","value","step","onChangeMode","onKeyDownEnter","isOnChangeModeFn","isOnKeyDownEnterFn","mode","_onTest","initedValue","_calcMode","_isChanged","strOrNumber","state","parseFloat","_increaseOnStep","valueNext","Big","plus","toString","nextMode","_callOnChangeMode","setState","_decreaseOnStep","minus","_handleClickRoot","input","focus","_handleInputChange","event","strValue","target","_updateValue","_handleInputKeyDown","keyCode","preventDefault","undefined","inputKey","_refInput","UNSAFE_componentWillReceiveProps","nextProps","render","inputStyle","id","_hrStyle","ROOT","ARROW","ARROW_PLUS","DIV_INPUT","INPUT","HR","ARROW_MINUS","getValue","setMode","Component","defaultProps"],"mappings":"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","sourcesContent":["import { Component } from 'react';\r\nimport Big from 'big.js'\r\n\r\nimport { isFunction, isFloat } from '../../utils/is'\r\nimport STYLE from './InputFloat.Style';\r\n\r\nconst _hmModeStyle = {\r\n  0 : STYLE.NOT_VALID,\r\n  1 : STYLE.VALID_CHANGED,\r\n  2 : STYLE.VALID_NOT_CHANGED\r\n}\r\n\r\nclass InputFloat extends Component {\r\n  /*\r\n   static propTypes = {\r\n     inputKey: PropTypes.string,\r\n     inputStyle: PropTypes.object,\r\n     value: PropTypes.oneOfType([\r\n       PropTypes.string,\r\n       PropTypes.number\r\n     ]),\r\n     step: PropTypes.number,\r\n     onChangeMode: PropTypes.func,\r\n     onKeyDownEnter: PropTypes.func\r\n   }\r\n   */\r\n   static defaultProps = {\r\n     inputKey: 'dfKey',\r\n     value: '0',\r\n     step: 0.1,\r\n     onChangeMode: () => {},\r\n     onKeyDownEnter: () => {}\r\n   }\r\n\r\n\r\n\r\n  _getInitedState = (props) => {\r\n     const { value, step, onChangeMode, onKeyDownEnter } = props\r\n\r\n     this.isOnChangeModeFn = isFunction(onChangeMode);\r\n     this.isOnKeyDownEnterFn = isFunction(onKeyDownEnter);\r\n\r\n     return {\r\n       mode : (this._onTest(value)) ? 2 : 0,\r\n       value : value,\r\n       initedValue : value,\r\n       step : step\r\n     };\r\n  }\r\n\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = this._getInitedState(props);\r\n  }\r\n\r\n  UNSAFE_componentWillReceiveProps(nextProps){\r\n    if (nextProps !== this.props){\r\n      this.setState(this._getInitedState(nextProps))\r\n    }\r\n  }\r\n\r\n  _calcMode = (value) => {\r\n    if (!this._onTest(value)){\r\n      return 0;\r\n    }\r\n    if (this._isChanged(value)){\r\n      return 1;\r\n    }\r\n    return 2;\r\n  }\r\n\r\n  _onTest = (strOrNumber) => {\r\n     return isFloat(strOrNumber);\r\n  }\r\n\r\n  _isChanged = (value) => {\r\n     return this.state.initedValue !== parseFloat(value);\r\n  }\r\n\r\n  _increaseOnStep = () => {\r\n    const { value, step } = this.state\r\n          , valueNext = (new Big(value)).plus(step).toString()\r\n          , nextMode = this._calcMode(valueNext)\r\n     this._callOnChangeMode(nextMode);\r\n     this.setState({\r\n        mode : nextMode,\r\n        value : valueNext\r\n     })\r\n  }\r\n\r\n  _decreaseOnStep = () => {\r\n    const { value, step } = this.state\r\n          , valueNext = (new Big(value)).minus(step).toString()\r\n          , nextMode = this._calcMode(valueNext)\r\n     this._callOnChangeMode(nextMode);\r\n     this.setState({\r\n        mode : nextMode,\r\n        value : valueNext\r\n     })\r\n  }\r\n\r\n  _handleClickRoot = () => {\r\n    this.input.focus();\r\n  }\r\n\r\n  _handleInputChange = (event) => {\r\n    const strValue = event.target.value\r\n    this._updateValue(strValue)\r\n  }\r\n\r\n  _handleInputKeyDown = (event) => {\r\n    switch(event.keyCode){\r\n      // enter\r\n       case 13 : {\r\n         if (this.isOnKeyDownEnterFn){\r\n           this.props.onKeyDownEnter();\r\n         }\r\n       break;}\r\n      // esc\r\n       case 27 :{\r\n          const { value, initedValue } = this.state\r\n          if ( value !== initedValue || \"\"+initedValue === \"0\") {\r\n            this._callOnChangeMode(2);\r\n            this.setState({ mode : 2, value : initedValue })\r\n          } else {\r\n            this._callOnChangeMode(1);\r\n            this.setState({ mode : 1, value : 0 })\r\n          }\r\n       break;}\r\n       //up\r\n       case 38 : {\r\n         event.preventDefault();\r\n         this._increaseOnStep();\r\n       break;}\r\n       //down\r\n       case 40 : {\r\n        event.preventDefault();\r\n        this._decreaseOnStep();\r\n       break;}\r\n       default : return undefined;\r\n    }\r\n  }\r\n\r\n  _callOnChangeMode = (nextMode) => {\r\n    const { mode } = this.state\r\n    if (this.isOnChangeModeFn && mode !== nextMode){\r\n      const { inputKey, onChangeMode } = this.props\r\n      onChangeMode(inputKey, nextMode);\r\n    }\r\n  }\r\n\r\n  _updateValue = (strValue) => {\r\n    const nextMode = this._calcMode(strValue)\r\n    this._callOnChangeMode(nextMode);\r\n    this.setState({\r\n      mode : nextMode,\r\n      value : strValue\r\n    })\r\n  }\r\n\r\n  _refInput = input => this.input = input\r\n\r\n  render(){\r\n    const { inputStyle, id } = this.props\r\n        , { value, mode } = this.state\r\n        , _hrStyle = _hmModeStyle[mode]\r\n\r\n    return (\r\n      <div\r\n         style={STYLE.ROOT}\r\n         onClick={this._handleClickRoot}\r\n      >\r\n        <button\r\n           style={{ ...STYLE.ARROW, ...STYLE.ARROW_PLUS}}\r\n           onClick={this._increaseOnStep}\r\n        />\r\n        <div style={STYLE.DIV_INPUT}>\r\n          <input\r\n            ref={this._refInput}\r\n            id={id}\r\n            type=\"text\"\r\n            style={{ ...STYLE.INPUT, ...inputStyle}}\r\n            value={value}\r\n            onChange={this._handleInputChange}\r\n            onKeyDown={this._handleInputKeyDown}\r\n          />\r\n          <hr style={{...STYLE.HR, ..._hrStyle}} />\r\n        </div>\r\n        <button\r\n           style={{ ...STYLE.ARROW, ...STYLE.ARROW_MINUS}}\r\n           onClick={this._decreaseOnStep}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getValue(){\r\n    return parseFloat(this.state.value);\r\n  }\r\n\r\n  setMode(mode){\r\n    if ( mode === 2){\r\n      const { value } = this.state\r\n      this.setState({ mode, initedValue : value })\r\n    } else {\r\n      this.setState({ mode })\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default InputFloat\r\n"],"file":"InputFloat.js"}